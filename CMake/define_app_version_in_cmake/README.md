# CMake: Defining the Application version in CMake file

## Introduction

There are various ways to define the version number of the application. A widely used method is to define the version number in the VERSION file in the project. However, it is also possible to define the version in the CMakeLists.txt file. This section explains how to do this. 

Note: further information about CMake can be found on [cmake.org](cmake.org).


## Required Hardware/Software for Hands-on
- development kit (e.g. nRF54LM20DK, nRF54L15DK, nrF54H20DK, nRF7002DK, nRF52840DK, nRF52833DK, or nRF52DK)
- install the _nRF Connect SDK_ and _Visual Studio Code_. 


## Hands-on step-by-step description 

1) Let's start with the hello_world project. Add this project to your Visual Studio Code workspace. 

2) CMake allows you to create various descriptions for the project using the [_project_](https://cmake.org/cmake/help/latest/command/project.html) CMake command. In addition to the project name, you can also define a version number, among other things. 

   <sup>CMakeLists.txt </sup>

       # Set project name:
       project (MyApp
                VERSION 2.3.4.5)

3) In order for the C source code to access this version number, we need to create a header file that allows access to the individual version numbers (major, minor, patch, tweak) via defines. To do this, we create a template file called _AppVerserion.h.in_.

   <sup>AppVersion.h.in </sup>

       // the configured options and settings for Tutorial
       #define MyApp_VERSION       "@MyApp_VERSION@"
       #define MyApp_VERSION_MAJOR @MyApp_VERSION_MAJOR@
       #define MyApp_VERSION_MINOR @MyApp_VERSION_MINOR@
       #define MyApp_VERSION_PATCH @MyApp_VERSION_PATCH@
       #define MyApp_VERSION_TWEAK @MyApp_VERSION_TWEAK@

> __Note:__ The variable name generated by the CMake command _project_ also uses the project name. Therefore, it is important to use the project name used in the variables for the version number. In our example, the project name is MyApp.

4) We now read this template file into CMakeLists.txt, insert the numbers defined in the CMake command _project_ into the CMake variables (e.g. @MyApp_VERSION_MAJOR@), and then save them in the include/AppVersion.h file.

   <sup>CMakeLists.txt </sup>

       # Configure a header file to pass the version number to the source code
       configure_file(AppVersion.h.in include/AppVersion.h)	

5) In order for the header file to be found in the project, we must also define that additional header files are available in the _include_ directory in our project build folder (see project build folder: _build/hello_world/include).

   <sup>CMakeLists.txt </sup>

       # add include directroies to the build
       include_directories(MyApp PUBLIC "${PROJECT_BINARY_DIR}/include")

6) In our main.c file, we add the include file AppVersion.h.

   <sup>src/main.c </sup>

       #include "AppVersion.h"

7) And as a final step, we output the app version number in the console. 

   <sup>src/main.c </sup>

           printf("Project Version: %s \n",MyApp_VERSION);
           printf("Project Version, major: %i \n",MyApp_VERSION_MAJOR);
           printf("Project Version, minor: %i \n",MyApp_VERSION_MINOR);
           printf("Project Version, patch: %i \n",MyApp_VERSION_PATCH);
           printf("Project Version, tweak: %i \n",MyApp_VERSION_TWEAK);


## Testing

5) Now build your project and check the output of the serial terminal. 
